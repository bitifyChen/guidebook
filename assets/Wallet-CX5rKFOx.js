import{k as $,_ as B,l as z,o as d,c as u,a as s,t as c,g as f,z as H,H as L,d as a,b as i,J as o,f as E,F as I,r as V,i as N,K as O,L as q,q as v,X as T,M as D,N as R,O as Z,P as G,Q as J,T as K,U as Q,V as X,W as Y,Y as A,Z as ee}from"./index-D6r3qpis.js";import{P as te}from"./plus-XK8OBCJ0.js";import{U as se}from"./users-Bj-o4h04.js";/**
 * @license lucide-vue-next v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=$("ReceiptTextIcon",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M14 8H8",key:"1l3xfs"}],["path",{d:"M16 12H8",key:"1fr5h0"}],["path",{d:"M13 16H8",key:"wsln4y"}]]);/**
 * @license lucide-vue-next v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=$("WalletMinimalIcon",[["path",{d:"M17 14h.01",key:"7oqj8z"}],["path",{d:"M7 7h12a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14",key:"u1rqew"}]]),ae={class:"flex items-center gap-4"},oe={class:"w-12 h-12 rounded-2xl overflow-hidden bg-orange-50 flex flex-col items-center justify-center font-black text-orange-500 text-xs border border-orange-100"},ne=["src"],ie={key:1,class:"scale-125"},de={class:"font-black text-slate-800 text-base leading-tight"},re={class:"text-[10px] font-bold text-slate-400 mt-1 flex items-center gap-1"},ce={class:"flex items-center gap-4"},pe={class:"text-right"},ue={class:"font-black text-slate-800 text-lg"},me={__name:"PayCard",props:{item:{type:Object,default:()=>({})}},emits:["edit"],setup(x,{emit:p}){const g=z(),n=x,t=H(()=>{var b;return g.getParticipant((b=n==null?void 0:n.item)==null?void 0:b.payerId)}),k=p,w=()=>k("edit",n.item);return(b,h)=>{var r,e,m,y;return d(),u("div",{onClick:w,class:"bg-white p-5 rounded-[24px] border border-slate-100 flex justify-between items-center shadow-sm hover:shadow-md transition-shadow"},[s("div",ae,[s("div",oe,[(r=t.value)!=null&&r.avatar?(d(),u("img",{key:0,src:t.value.avatar,class:"w-full h-full object-cover"},null,8,ne)):(d(),u("span",ie,c(((m=(e=t.value)==null?void 0:e.name)==null?void 0:m[0])||"?"),1))]),s("div",null,[s("h4",de,c(x.item.description),1),s("p",re,[f(c(x.item.date)+" ",1),h[0]||(h[0]=s("span",{class:"opacity-30"},"•",-1)),f(" 由 "+c((y=t.value)==null?void 0:y.name)+" 付款 ",1)])])]),s("div",ce,[s("div",pe,[s("span",ue,"₩"+c(x.item.amount.toLocaleString()),1)])])])}}},fe=B(me,[["__scopeId","data-v-f0fcbfdb"]]),xe={class:"space-y-8"},be={class:"bg-gradient-to-br from-slate-800 to-slate-900 rounded-[32px] p-8 text-white shadow-2xl relative overflow-hidden group"},_e={class:"relative z-10"},ge={class:"flex items-center gap-2 mb-2 opacity-60"},he={class:"flex items-baseline gap-2"},ye={class:"text-4xl font-black tracking-tight"},ve={class:"space-y-4"},ke={class:"flex justify-between items-end mb-4"},we={class:"text-[10px] font-black text-slate-400 uppercase tracking-widest"},Ie={key:0,class:"flex flex-col items-center py-20 text-slate-300"},Ve={class:"p-4"},We={class:"flex justify-between items-center mb-8"},Ee={class:"text-2xl font-black text-slate-800"},Ce={class:"grid grid-cols-2 gap-4"},$e={class:"h-12 bg-slate-50 rounded-2xl flex items-center px-4 gap-2 text-slate-500"},ze={class:"text-sm font-bold"},Me={class:"mt-8 flex gap-4"},Pe={__name:"Wallet",setup(x){const p=L(),g=z(),n=N(!1),t=X({amount:"",description:"",payerId:"",splitWithIds:[]}),k=r=>{Object.assign(t,r),n.value=!0},w=()=>{if(!t.amount||!t.description||!t.payerId)return alert("請填寫完整的開支資訊！");t.id?A(t.id,{amount:parseFloat(t.amount),description:t.description,payerId:t.payerId,splitWithIds:[...t.splitWithIds]}).then(r=>{console.log("更新成功",r)}).finally(()=>{p.init()}):ee({amount:parseFloat(t.amount),description:t.description,payerId:t.payerId,splitWithIds:[...t.splitWithIds]}).then(r=>{console.log("新增成功",r)}).finally(()=>{p.init()}),n.value=!1},b=()=>{t.id&&confirm("確定要刪除這筆開支嗎？")&&(Y(t.id).then(r=>{console.log("刪除成功",r)}).finally(()=>{p.init()}),n.value=!1)},h=()=>{Object.assign(t,{id:null,amount:"",description:"",payerId:"",splitWithIds:[]})};return(r,e)=>{const m=O,y=fe,W=Z,_=R,M=J,j=G,S=Q,U=K,P=D,F=q;return d(),u("div",xe,[s("div",be,[s("div",_e,[s("div",ge,[a(i(le),{size:14}),e[7]||(e[7]=s("p",{class:"text-[10px] font-black uppercase tracking-[0.2em]"}," 旅行總支出 ",-1))]),s("div",he,[e[8]||(e[8]=s("span",{class:"text-xl font-bold text-orange-400"},"₩",-1)),s("h2",ye,c(i(p).totalSpent.toLocaleString()),1)]),a(m,{class:"w-full !rounded-[20px] !h-14 mt-8 !text-lg !font-black !bg-orange-500 !border-none !text-white shadow-xl shadow-orange-900/20 active:scale-95 transition-transform",onClick:e[0]||(e[0]=l=>n.value=!0)},{default:o(()=>[a(i(te),{size:20,class:"mr-2 stroke-[3px]"}),e[9]||(e[9]=f(" 新增行程開支 ",-1))]),_:1})]),a(i(C),{size:120,class:"absolute -bottom-6 -right-6 opacity-10 rotate-12 group-hover:scale-110 transition-transform duration-700"})]),s("div",ve,[s("div",ke,[e[10]||(e[10]=s("h3",{class:"font-black text-slate-800 text-xl tracking-tight"}," 費用明細 ",-1)),s("span",we,c(i(p).expenses.length)+" 筆記錄",1)]),i(p).expenses.length===0?(d(),u("div",Ie,[a(i(C),{size:48,class:"opacity-20 mb-2"}),e[11]||(e[11]=s("p",{class:"italic font-medium"},"尚未有任何開銷紀錄",-1))])):E("",!0),(d(!0),u(I,null,V(i(p).expenses,l=>(d(),v(y,{key:l.id,item:l,onEdit:k},null,8,["item"]))),128))]),a(F,{modelValue:n.value,"onUpdate:modelValue":e[6]||(e[6]=l=>n.value=l),direction:"btt",size:"auto","with-header":!1,"append-to-body":!0,class:"custom-drawer",onClose:h},{default:o(()=>[s("div",Ve,[s("div",We,[s("h2",Ee,c(t.id?"編輯":"新增")+"這筆開支 ",1),s("button",{onClick:e[1]||(e[1]=l=>n.value=!1),class:"p-2 bg-slate-100 rounded-full text-slate-400"},[a(i(T),{size:20})])]),a(P,{"label-position":"top",class:"custom-form"},{default:o(()=>[a(_,null,{label:o(()=>[...e[12]||(e[12]=[s("span",{class:"label-custom"},"支出金額 (₩)",-1)])]),default:o(()=>[a(W,{modelValue:t.amount,"onUpdate:modelValue":e[2]||(e[2]=l=>t.amount=l),type:"number",placeholder:"0",class:"custom-input"},null,8,["modelValue"])]),_:1}),a(_,null,{label:o(()=>[...e[13]||(e[13]=[s("span",{class:"label-custom"},"支出內容",-1)])]),default:o(()=>[a(W,{modelValue:t.description,"onUpdate:modelValue":e[3]||(e[3]=l=>t.description=l),placeholder:"例如：漢拿山炒飯",class:"custom-input"},null,8,["modelValue"])]),_:1}),s("div",Ce,[a(_,null,{label:o(()=>[...e[14]||(e[14]=[s("span",{class:"label-custom tracking-tighter"},"誰先墊錢？",-1)])]),default:o(()=>[a(j,{modelValue:t.payerId,"onUpdate:modelValue":e[4]||(e[4]=l=>t.payerId=l),class:"w-full custom-select",placeholder:"選擇付款人"},{default:o(()=>[(d(!0),u(I,null,V(i(g).participants,l=>(d(),v(M,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(_,null,{label:o(()=>[...e[15]||(e[15]=[s("span",{class:"label-custom tracking-tighter"},"參與人數",-1)])]),default:o(()=>[s("div",$e,[a(i(se),{size:16}),s("span",ze,c(t.splitWithIds.length)+" 人",1)])]),_:1})]),a(_,null,{label:o(()=>[...e[16]||(e[16]=[s("span",{class:"label-custom"},"要跟誰分這筆錢？",-1)])]),default:o(()=>[a(U,{modelValue:t.splitWithIds,"onUpdate:modelValue":e[5]||(e[5]=l=>t.splitWithIds=l),class:"flex flex-wrap gap-2"},{default:o(()=>[(d(!0),u(I,null,V(i(g).participants,l=>(d(),v(S,{key:l.id,label:l.id,class:"custom-checkbox",border:""},{default:o(()=>[f(c(l.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),s("div",Me,[t.id?(d(),v(m,{key:0,type:"primary",onClick:b,class:"w-full !h-16 !rounded-[24px] !bg-red-500 !border-none !text-xl !font-black shadow-xl shadow-red-100 !ml-0"},{default:o(()=>[...e[17]||(e[17]=[f("刪除這筆開支",-1)])]),_:1})):E("",!0),a(m,{type:"primary",onClick:w,class:"w-full !h-16 !rounded-[24px] !bg-orange-500 !border-none !text-xl !font-black shadow-xl shadow-orange-100"},{default:o(()=>[f(c(t.id?"更新":"儲存")+"這筆開支",1)]),_:1})])])]),_:1},8,["modelValue"])])}}};export{Pe as default};
