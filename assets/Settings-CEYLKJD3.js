import{k as p,u as C,n as S,i as d,q as M,o as l,c as f,a as e,d as r,b as s,g as c,O as _,t as u,L as h,f as z,$ as I,F as V,r as N,M as B,a0 as P,R as T}from"./index-5a36mV7Q.js";/* empty css                 */import{T as q}from"./trash-2-BSSIBCos.js";/**
 * @license lucide-vue-next v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=p("BellIcon",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-vue-next v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=p("ShieldAlertIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-vue-next v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=p("ShieldCheckIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=p("UserPlusIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),L={class:"p-4 space-y-6"},R={class:"bg-white rounded-3xl p-6 shadow-sm border border-slate-100"},A={class:"font-bold text-slate-800 mb-4 flex items-center gap-2"},H={class:"space-y-4"},K={class:"flex items-center justify-between p-4 bg-slate-50 rounded-2xl"},$={class:"space-y-1"},D={class:"flex items-center gap-2"},O={class:"font-bold text-slate-700"},G={class:"p-4 bg-slate-50 rounded-2xl space-y-2"},J={class:"text-[10px] font-mono break-all text-slate-500 bg-white p-2 rounded-lg border border-slate-100"},Q={class:"bg-white rounded-3xl p-6 shadow-sm border border-slate-100"},W={class:"font-bold text-slate-800 mb-4 flex items-center gap-2"},X={class:"flex gap-2 mb-6"},Y={class:"space-y-3"},Z={class:"flex items-center gap-3"},ee={class:"w-8 h-8 rounded-full bg-orange-100 text-orange-500 flex items-center justify-center font-bold text-xs"},te={class:"font-medium text-slate-700"},se=["onClick"],re={__name:"Settings",setup(ae){const m=C(),b=S(),i=d(""),a=d(Notification.permission),v=d(localStorage.getItem("fcm_token")||"尚未取得"),x=d(!1),g=async()=>{var y;x.value=!0;try{const t=((y=b.user)==null?void 0:y.uid)||"anonymous",o=await P(t);o&&(v.value=o,localStorage.setItem("fcm_token",o),a.value=Notification.permission,alert("推播通知已成功啟用！"))}catch(t){alert("啟用失敗："+t.message)}finally{x.value=!1}};M(()=>{a.value=Notification.permission});const k=()=>{i.value&&(m.addParticipant(i.value),i.value="")};return(y,t)=>{const o=B,w=T;return l(),f("div",L,[e("div",R,[e("h3",A,[r(s(j),{size:18,class:"text-blue-500"}),t[1]||(t[1]=c(" 裝置推播設定 ",-1))]),e("div",H,[e("div",K,[e("div",$,[t[2]||(t[2]=e("p",{class:"text-[10px] font-black text-slate-400 uppercase tracking-widest"},"通知權限狀態",-1)),e("div",D,[a.value==="granted"?(l(),_(s(E),{key:0,size:16,class:"text-green-500"})):(l(),_(s(U),{key:1,size:16,class:"text-orange-500"})),e("span",O,u(a.value==="granted"?"已允許":a.value==="denied"?"已拒絕":"尚未詢問"),1)])]),a.value!=="granted"?(l(),_(o,{key:0,type:"primary",size:"small",class:"!rounded-xl",onClick:g,loading:x.value},{default:h(()=>[...t[3]||(t[3]=[c(" 啟動通知 ",-1)])]),_:1},8,["loading"])):z("",!0)]),e("div",G,[t[4]||(t[4]=e("p",{class:"text-[10px] font-black text-slate-400 uppercase tracking-widest"},"FCM Token (裝置識別碼)",-1)),e("p",J,u(v.value),1),e("button",{onClick:g,class:"text-[10px] font-bold text-blue-500 hover:underline"}," 手動更新 Token ")])])]),e("div",Q,[e("h3",W,[r(s(F),{size:18,class:"text-orange-500"}),t[5]||(t[5]=c(" 行員管理 ",-1))]),e("div",X,[r(w,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=n=>i.value=n),placeholder:"成員姓名...",onKeyup:I(k,["enter"])},null,8,["modelValue"]),r(o,{type:"primary",onClick:k},{default:h(()=>[...t[6]||(t[6]=[c("新增",-1)])]),_:1})]),e("div",Y,[(l(!0),f(V,null,N(s(m).participants,n=>(l(),f("div",{key:n.id,class:"flex items-center justify-between p-3 bg-slate-50 rounded-2xl"},[e("div",Z,[e("div",ee,u(n.name[0]),1),e("span",te,u(n.name),1)]),e("button",{onClick:oe=>s(m).removeParticipant(n.id),class:"text-slate-300 hover:text-red-500"},[r(s(q),{size:16})],8,se)]))),128))])])])}}};export{re as default};
